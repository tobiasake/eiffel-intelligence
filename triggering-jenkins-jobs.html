<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2019-12-02 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20191202" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Eiffel Intelligence &#x2013; Trigger Jenkins</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

          
                      </head>
        <body class="topBarEnabled">
          
                
                    
                

    <div id="topbar" class="navbar navbar-fixed-top navbar-inverse">
      <div class="navbar-inner">
                <div class="container-fluid">
        <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
                
                                                                                                    <a class="brand" href="./" >

                                
                                    Eiffel Intelligence
                
                </a>
                    
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="index.html"  title="Home">Home</a>
</li>
                  
                      <li class="dropdown-submenu">
                                      <a href="running-eiffel-intelligence.html"  title="Running Eiffel Intelligence">Running Eiffel Intelligence</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="configuration.html"  title="Configuration">Configuration</a>
</li>
                                  <li>      <a href="docker.html"  title="Running in Docker">Running in Docker</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="subscriptions.html"  title="Understanding subscriptions">Understanding subscriptions</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="subscription-with-REST-POST-notification.html"  title="Subscription with REST POST notification">Subscription with REST POST notification</a>
</li>
                                  <li>      <a href="triggering-jenkins-jobs.html"  title="HTTP POST notification to trigger parameterized Jenkins jobs">HTTP POST notification to trigger parameterized Jenkins jobs</a>
</li>
                                  <li>      <a href="subscription-with-email-notification.html"  title="Subscription with Email notification">Subscription with Email notification</a>
</li>
                                  <li>      <a href="step-by-step-subscription-notification.html"  title="Step-by-step Subscription Notification">Step-by-step Subscription Notification</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="rules.html"  title="Understanding rules">Understanding rules</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="merge-resolver-rules.html"  title="Merge Resolver Rules">Merge Resolver Rules</a>
</li>
                                  <li>      <a href="history-rules.html"  title="History Rules">History Rules</a>
</li>
                                  <li>      <a href="example-rules.html"  title="Example Rules">Example Rules</a>
</li>
                                  <li>      <a href="mapping-rules-to-aggregations.html"  title="Mapping Rules To Aggregations">Mapping Rules To Aggregations</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="step-by-step-aggregation.html"  title="Step-by-step aggregation">Step-by-step aggregation</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="artifact-created-event-aggregation.html"  title="ArtifactCreatedEvent aggregation">ArtifactCreatedEvent aggregation</a>
</li>
                                  <li>      <a href="test-case-triggered-event-aggregation.html"  title="TestCaseTriggeredEvent aggregation">TestCaseTriggeredEvent aggregation</a>
</li>
                                  <li>      <a href="test-case-started-event-aggregation.html"  title="TestCaseStartedEvent aggregation">TestCaseStartedEvent aggregation</a>
</li>
                                  <li>      <a href="test-case-finished-event-aggregation.html"  title="TestCaseFinishedEvent aggregation">TestCaseFinishedEvent aggregation</a>
</li>
                                  <li>      <a href="artifact-published-event-aggregation.html"  title="ArtifactPublishedEvent aggregation">ArtifactPublishedEvent aggregation</a>
</li>
                                  <li>      <a href="confidence-level-modified-event-aggregation.html"  title="ConfidenceLevelModifiedEvent">ConfidenceLevelModifiedEvent</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="REST-API.html"  title="REST API">REST API</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="query.html"  title="Query">Query</a>
</li>
                                  <li>      <a href="failed-notifications.html"  title="Failed notifications">Failed notifications</a>
</li>
                                  <li>      <a href="running-rules-on-objects.html"  title="Running rules on objects">Running rules on objects</a>
</li>
                                  <li>      <a href="authentication.html"  title="Authentication">Authentication</a>
</li>
                                  <li>      <a href="subscription-API.html"  title="Subscriptions">Subscriptions</a>
</li>
                                  <li>      <a href="status.html"  title="Status">Status</a>
</li>
                                  <li>      <a href="templates.html"  title="Get templates">Get templates</a>
</li>
                              </ul>
            </li>
                  
                      <li>      <a href="compatibility.html"  title="Compatibility">Compatibility</a>
</li>
                  
                      <li>      <a href="known-limitations.html"  title="Known limitations">Known limitations</a>
</li>
                          </ul>
      </li>
                  </ul>
          
          
          
                   
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Eiffel Intelligence</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="index.html" title="Home">
        Home</a>
                    <span class="divider">-</span>
      </li>
        <li class="active ">Trigger Jenkins</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2019-12-02</li>
              <li id="projectVersion" class="pull-right">
                    Version: 2.0.0
        </li>
            
                            </ul>
      </div>

                  
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                              
      <li>
  
                          <a href="index.html" title="Home">
          <span class="none"></span>
        Home</a>
            </li>
                                                                                    
      <li>
  
                          <a href="running-eiffel-intelligence.html" title="Running Eiffel Intelligence">
          <span class="icon-chevron-right"></span>
        Running Eiffel Intelligence</a>
                  </li>
                                                                                                                                  
      <li>
  
                          <a href="subscriptions.html" title="Understanding subscriptions">
          <span class="icon-chevron-down"></span>
        Understanding subscriptions</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="subscription-with-REST-POST-notification.html" title="Subscription with REST POST notification">
          <span class="none"></span>
        Subscription with REST POST notification</a>
            </li>
                    
      <li class="active">
  
            <a href="#"><span class="none"></span>HTTP POST notification to trigger parameterized Jenkins jobs</a>
          </li>
                    
      <li>
  
                          <a href="subscription-with-email-notification.html" title="Subscription with Email notification">
          <span class="none"></span>
        Subscription with Email notification</a>
            </li>
                    
      <li>
  
                          <a href="step-by-step-subscription-notification.html" title="Step-by-step Subscription Notification">
          <span class="none"></span>
        Step-by-step Subscription Notification</a>
            </li>
              </ul>
        </li>
                                                                                                                        
      <li>
  
                          <a href="rules.html" title="Understanding rules">
          <span class="icon-chevron-right"></span>
        Understanding rules</a>
                  </li>
                                                                                                                                                            
      <li>
  
                          <a href="step-by-step-aggregation.html" title="Step-by-step aggregation">
          <span class="icon-chevron-right"></span>
        Step-by-step aggregation</a>
                  </li>
                                                                                                                                                                              
      <li>
  
                          <a href="REST-API.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                
      <li>
  
                          <a href="compatibility.html" title="Compatibility">
          <span class="none"></span>
        Compatibility</a>
            </li>
                
      <li>
  
                          <a href="known-limitations.html" title="Known limitations">
          <span class="none"></span>
        Known limitations</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                        
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>Trigger Jenkins</h1>
<p>On this page we only explain the subscription fields which are relevant to trigger Jenkins jobs. For explanations of the other fields in the subscriptions, see <a class="externalLink" href="https://github.com/eiffel-community/eiffel-intelligence/blob/master/wiki/markdown/subscription-with-REST-POST-notification.md">REST POST subscription</a>.</p>
<p>There are some important details to know when triggering Jenkins jobs with parameters and/or token.</p>
<div class="section">
<h2><a name="Using_token"></a>Using <i><b>token</b></i></h2>

<div>
<div>
<pre class="source">Tokens need to be treated as constants so they should be surrounded with single quotes. See examples below.
</pre></div></div>
</div>
<div class="section">
<h2><a name="buildWithParameters_endpoint"></a><i><b>buildWithParameters</b></i> endpoint</h2>
<ul>

<li>Jenkins discards the body specified in notificationMessageKeyValues</li>
<li>the parameters need to be send in the URL</li>
<li>do not specify more parameters than you have in your job. This is a Jenkins security feature to hinder that someone triggers jobs that overwrite job environment variables. Your job will not be triggered otherwise.</li>
</ul>
<p>Example below shows a subscription that triggers a parameterized Jenkins job having job token and a parameter object containing the aggregated object. Observe that we use buildWithParameters and empty notificationMessageKeyValues.</p>
<div class="section">
<h3><a name="authenticationType"></a>authenticationType</h3>
<p>If any authentication is needed by Eiffel Intelligence to send the notification HTTP request. This authentication type is &#x201c;Jenkins CSRF Protection (crumb)&#x201d;, in which the username and password will be Base 64 encoded. A crumb will be fetched automatically before the HTTP request is made. (Currently default in many Jenkins instances). Even if the Jenkins instance has CSRF disabled this authentication type works. BASIC_AUTH can also be used.</p></div>
<div class="section">
<h3><a name="userName_.26_password"></a>userName &amp; password</h3>
<p>The username and password Eiffel Intelligence will use in headers of the HTTP request when sending a notification via HTTP POST.</p></div>
<div class="section">
<h3><a name="notificationMeta"></a>notificationMeta</h3>
<p>Which url to use for the HTTP POST request. This url contains parameters to trigger a specific Jenkins job.</p></div>
<div class="section">
<h3><a name="restPostBodyMediaType"></a>restPostBodyMediaType</h3>
<p>Headers for the HTTP request, can be &#x2018;application/x-www-form-urlencoded&#x2019; or &#x2018;application/json&#x2019;.</p></div>
<div class="section">
<h3><a name="notificationMessageKeyValues"></a>notificationMessageKeyValues</h3>
<p>The data to send with the HTTP POST request. Jenkins ignores any body sent so we leave it empty in the first subscription.</p>
<p>For the second subscription example we use &#x2018;application/json&#x2019;. The form key should be left empty. The form value will be run through JMESPath engine so it is possible to use JMESPath expressions to extract content from the aggregated object. The form value can only be one JSON object.</p>

<div>
<div>
<pre class="source">{
    &quot;subscriptionName&quot; : &quot;Subscription1&quot;,
    &quot;ldapUserName&quot; : &quot;ABC&quot;,
    &quot;repeat&quot; : false,
    &quot;created&quot; : 1542117412833,

    &quot;authenticationType&quot; : &quot;BASIC_AUTH_JENKINS_CSRF&quot;,
    &quot;userName&quot; : &quot;functionalUser&quot;,
    &quot;password&quot; : &quot;functionalUserPassword&quot;,

    &quot;notificationType&quot; : &quot;REST_POST&quot;,
    &quot;notificationMeta&quot; : &quot;http://eiffel-jenkins1:8080/job/ei-artifact-triggered-job/buildWithParameters?token='TOKEN'&amp;object=id&quot;,

    &quot;restPostBodyMediaType&quot; : &quot;application/json&quot;,
    &quot;notificationMessageKeyValues&quot; : [
        {
        }
    ],
    &quot;requirements&quot; : [
        {
            &quot;conditions&quot; : [
                {
                    &quot;jmespath&quot; : &quot;identity=='pkg:maven/com.othercompany.library/artifact-name@1.0.0'&quot;
                }
            ]
        }
    ]
}
</pre></div></div>
</div></div>
<div class="section">
<h2><a name="build_endpoint"></a><i><b>build</b></i> endpoint</h2>
<ul>

<li>the parameters should be specified in notificationMessageKeyValues. The same rule of not adding more parameters than the job is configured with applies here. Your job will not be triggered otherwise.</li>
<li>no job parameters in the URL</li>
</ul>
<p>The subscription below triggers the same parameterized Jenkins job but we now use the build endpoint and we send the parameters in a json form using REST body.</p>

<div>
<div>
<pre class="source">{
    &quot;subscriptionName&quot; : &quot;Subscription1&quot;,
    &quot;ldapUserName&quot; : &quot;ABC&quot;,
    &quot;repeat&quot; : false,
    &quot;created&quot; : 1542117412833,

    &quot;authenticationType&quot; : &quot;BASIC_AUTH_JENKINS_CSRF&quot;,
    &quot;userName&quot; : &quot;functionalUser&quot;,
    &quot;password&quot; : &quot;functionalUserPassword&quot;,

    &quot;notificationType&quot; : &quot;REST_POST&quot;,
    &quot;notificationMeta&quot; : &quot;http://eiffel-jenkins1:8080/job/ei-artifact-triggered-job/build?token='TOKEN'&quot;,

    &quot;restPostBodyMediaType&quot; : &quot;application/json&quot;,
    &quot;notificationMessageKeyValues&quot; : [
        {
            &quot;formkey&quot; : &quot;&quot;,
            &quot;formvalue&quot; : &quot;{parameter: [{ name: 'object', value : to_string(@) }]}&quot;
        }
    ],
    &quot;requirements&quot; : [
        {
            &quot;conditions&quot; : [
                {
                    &quot;jmespath&quot; : &quot;identity=='pkg:maven/com.othercompany.library/artifact-name@1.0.0'&quot;
                },
                {
                    &quot;jmespath&quot; : &quot;confidenceLevels[?name=='my_confidence_level']&quot;
                }
            ]
        }
    ]
}
</pre></div></div>
</div>
<div class="section">
<h2><a name="Requirements_and_conditions"></a>Requirements and conditions</h2>
<p>Read more on how Eiffel Intelligence groups <a class="externalLink" href="https://github.com/eiffel-community/eiffel-intelligence/blob/master/wiki/markdown/subscriptions.md#writing-requirements-and-conditions">requirements and conditions in subscriptions</a>.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                          
                </div>

        
                </div>
    </footer>
        </body>
</html>
