<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2019-12-02 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20191202" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Eiffel Intelligence &#x2013; Subscription with REST POST notification</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

          
                      </head>
        <body class="topBarEnabled">
          
                
                    
                

    <div id="topbar" class="navbar navbar-fixed-top navbar-inverse">
      <div class="navbar-inner">
                <div class="container-fluid">
        <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
                
                                                                                                    <a class="brand" href="./" >

                                
                                    Eiffel Intelligence
                
                </a>
                    
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="index.html"  title="Home">Home</a>
</li>
                  
                      <li class="dropdown-submenu">
                                      <a href="running-eiffel-intelligence.html"  title="Running Eiffel Intelligence">Running Eiffel Intelligence</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="configuration.html"  title="Configuration">Configuration</a>
</li>
                                  <li>      <a href="docker.html"  title="Running in Docker">Running in Docker</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="subscriptions.html"  title="Understanding subscriptions">Understanding subscriptions</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="subscription-with-REST-POST-notification.html"  title="Subscription with REST POST notification">Subscription with REST POST notification</a>
</li>
                                  <li>      <a href="triggering-jenkins-jobs.html"  title="HTTP POST notification to trigger parameterized Jenkins jobs">HTTP POST notification to trigger parameterized Jenkins jobs</a>
</li>
                                  <li>      <a href="subscription-with-email-notification.html"  title="Subscription with Email notification">Subscription with Email notification</a>
</li>
                                  <li>      <a href="step-by-step-subscription-notification.html"  title="Step-by-step Subscription Notification">Step-by-step Subscription Notification</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="rules.html"  title="Understanding rules">Understanding rules</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="merge-resolver-rules.html"  title="Merge Resolver Rules">Merge Resolver Rules</a>
</li>
                                  <li>      <a href="history-rules.html"  title="History Rules">History Rules</a>
</li>
                                  <li>      <a href="example-rules.html"  title="Example Rules">Example Rules</a>
</li>
                                  <li>      <a href="mapping-rules-to-aggregations.html"  title="Mapping Rules To Aggregations">Mapping Rules To Aggregations</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="step-by-step-aggregation.html"  title="Step-by-step aggregation">Step-by-step aggregation</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="artifact-created-event-aggregation.html"  title="ArtifactCreatedEvent aggregation">ArtifactCreatedEvent aggregation</a>
</li>
                                  <li>      <a href="test-case-triggered-event-aggregation.html"  title="TestCaseTriggeredEvent aggregation">TestCaseTriggeredEvent aggregation</a>
</li>
                                  <li>      <a href="test-case-started-event-aggregation.html"  title="TestCaseStartedEvent aggregation">TestCaseStartedEvent aggregation</a>
</li>
                                  <li>      <a href="test-case-finished-event-aggregation.html"  title="TestCaseFinishedEvent aggregation">TestCaseFinishedEvent aggregation</a>
</li>
                                  <li>      <a href="artifact-published-event-aggregation.html"  title="ArtifactPublishedEvent aggregation">ArtifactPublishedEvent aggregation</a>
</li>
                                  <li>      <a href="confidence-level-modified-event-aggregation.html"  title="ConfidenceLevelModifiedEvent">ConfidenceLevelModifiedEvent</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="REST-API.html"  title="REST API">REST API</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="query.html"  title="Query">Query</a>
</li>
                                  <li>      <a href="failed-notifications.html"  title="Failed notifications">Failed notifications</a>
</li>
                                  <li>      <a href="running-rules-on-objects.html"  title="Running rules on objects">Running rules on objects</a>
</li>
                                  <li>      <a href="authentication.html"  title="Authentication">Authentication</a>
</li>
                                  <li>      <a href="subscription-API.html"  title="Subscriptions">Subscriptions</a>
</li>
                                  <li>      <a href="status.html"  title="Status">Status</a>
</li>
                                  <li>      <a href="templates.html"  title="Get templates">Get templates</a>
</li>
                              </ul>
            </li>
                  
                      <li>      <a href="compatibility.html"  title="Compatibility">Compatibility</a>
</li>
                  
                      <li>      <a href="known-limitations.html"  title="Known limitations">Known limitations</a>
</li>
                          </ul>
      </li>
                  </ul>
          
          
          
                   
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Eiffel Intelligence</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="index.html" title="Home">
        Home</a>
                    <span class="divider">-</span>
      </li>
        <li class="active ">Subscription with REST POST notification</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2019-12-02</li>
              <li id="projectVersion" class="pull-right">
                    Version: 2.0.0
        </li>
            
                            </ul>
      </div>

                  
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                              
      <li>
  
                          <a href="index.html" title="Home">
          <span class="none"></span>
        Home</a>
            </li>
                                                                                    
      <li>
  
                          <a href="running-eiffel-intelligence.html" title="Running Eiffel Intelligence">
          <span class="icon-chevron-right"></span>
        Running Eiffel Intelligence</a>
                  </li>
                                                                                                                                  
      <li>
  
                          <a href="subscriptions.html" title="Understanding subscriptions">
          <span class="icon-chevron-down"></span>
        Understanding subscriptions</a>
                    <ul class="nav nav-list">
                    
      <li class="active">
  
            <a href="#"><span class="none"></span>Subscription with REST POST notification</a>
          </li>
                    
      <li>
  
                          <a href="triggering-jenkins-jobs.html" title="HTTP POST notification to trigger parameterized Jenkins jobs">
          <span class="none"></span>
        HTTP POST notification to trigger parameterized Jenkins jobs</a>
            </li>
                    
      <li>
  
                          <a href="subscription-with-email-notification.html" title="Subscription with Email notification">
          <span class="none"></span>
        Subscription with Email notification</a>
            </li>
                    
      <li>
  
                          <a href="step-by-step-subscription-notification.html" title="Step-by-step Subscription Notification">
          <span class="none"></span>
        Step-by-step Subscription Notification</a>
            </li>
              </ul>
        </li>
                                                                                                                        
      <li>
  
                          <a href="rules.html" title="Understanding rules">
          <span class="icon-chevron-right"></span>
        Understanding rules</a>
                  </li>
                                                                                                                                                            
      <li>
  
                          <a href="step-by-step-aggregation.html" title="Step-by-step aggregation">
          <span class="icon-chevron-right"></span>
        Step-by-step aggregation</a>
                  </li>
                                                                                                                                                                              
      <li>
  
                          <a href="REST-API.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                
      <li>
  
                          <a href="compatibility.html" title="Compatibility">
          <span class="none"></span>
        Compatibility</a>
            </li>
                
      <li>
  
                          <a href="known-limitations.html" title="Known limitations">
          <span class="none"></span>
        Known limitations</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                        
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>Subscription with REST POST notification</h1>
<p>Valid subscriptions for REST POST notifications are provided below with each field explained.</p>
<p><b>Subscription templates can be found <a class="externalLink" href="https://github.com/eiffel-community/eiffel-intelligence/tree/master/src/main/resources/templates">here</a>.</b></p>
<div class="section">
<h2><a name="subscriptionName"></a>subscriptionName</h2>
<p>The name of the subscription to make it easy to search for. Only numbers, letters and underscore allowed.</p></div>
<div class="section">
<h2><a name="ldapUserName"></a>ldapUserName</h2>
<p>The name of the logged in user creating or updating the subscription. Added by Eiffel Intelligence if LDAP is enabled. Not required. Defaults to an empty string.</p></div>
<div class="section">
<h2><a name="repeat"></a>repeat</h2>
<p>Instructs whether the same subscription should be re-triggered for new additions to the aggregated object. If this is set to false, only the first time the conditions are fulfilled, a notification will be triggered. No matter how many times the aggregated object is updated.</p></div>
<div class="section">
<h2><a name="created"></a>created</h2>
<p>Creation time in system time, added by Eiffel Intelligence.</p></div>
<div class="section">
<h2><a name="notificationType"></a>notificationType</h2>
<p>How Eiffel Intelligence should notify when a subscription is fulfilled.</p></div>
<div class="section">
<h2><a name="notificationMeta"></a>notificationMeta</h2>
<p>Which url to use for the HTTP POST request. This field requires a schema to work. That means the &#x2018;http://&#x2019; part of a url needs to be included.</p></div>
<div class="section">
<h2><a name="restPostBodyMediaType"></a>restPostBodyMediaType</h2>
<p>Which headers to use for the HTTP request, they can be &#x2018;application/x-www-form-urlencoded&#x2019; or &#x2018;application/json&#x2019;.</p></div>
<div class="section">
<h2><a name="notificationMessageKeyValues"></a>notificationMessageKeyValues</h2>
<p>The data to send in the HTTP POST request body. When using &#x2018;application/json&#x2019; the form key should be left empty.</p>
<p>With &#x2018;application/x-www-form-urlencoded&#x2019; for REST_POST it is possible to have multiple key/value pairs in the notification message. The form key should match the external API to which Eiffel Intelligence will send the notification of a fulfilled subscription.</p>
<p>The form value will be run through JMESPath engine so it is possible to use JMESPath expressions to extract content from the aggregated object. The form value can only be one JSON object.</p></div>
<div class="section">
<h2><a name="authenticationType"></a>authenticationType</h2>
<p>If any authentication is needed by Eiffel Intelligence to send the notification HTTP request.</p></div>
<div class="section">
<h2><a name="userName_.26_password"></a>userName &amp; password</h2>
<p>The username and password Eiffel Intelligence will use in headers of the HTTP request Eiffel Intelligence sends a notification via HTTP POST.</p></div>
<div class="section">
<h2><a name="requirements"></a>requirements</h2>
<p>An array of one or several requirements. At least one requirement should be fulfilled to trigger this subscription. A requirement can have several conditions.</p></div>
<div class="section">
<h2><a name="conditions"></a>conditions</h2>
<p>Array of conditions. The key in the condition object must be &#x201c;jmespath&#x201d;. The value can be any JMESPath expression to extract data from the aggregated object. All conditions needs to be fulfilled in order for a requirement to be fulfilled.</p>
<p>Notice the single quotes surrounding the value to be checked. This tells JMESPath that this is a constant and not an object from the aggregated object.</p>

<div>
<div>
<pre class="source">{
    &quot;subscriptionName&quot; : &quot;Subscription1&quot;,
    &quot;ldapUserName&quot; : &quot;ABC&quot;,
    &quot;repeat&quot; : false,
    &quot;created&quot; : 1542117412833,

    &quot;notificationType&quot; : &quot;REST_POST&quot;,
    &quot;notificationMeta&quot; : &quot;http://myAwesomeService:8080/api/send&quot;,

    &quot;restPostBodyMediaType&quot; : &quot;application/json&quot;,
    &quot;notificationMessageKeyValues&quot; : [
        {
            &quot;formkey&quot; : &quot;&quot;,
            &quot;formvalue&quot; : &quot;{parameter: [{ name: 'jsonparams', value : to_string(@) }]}&quot;
        }
    ],
    
    &quot;authenticationType&quot; : &quot;BASIC_AUTH&quot;,
    &quot;userName&quot; : &quot;functionalUser&quot;,
    &quot;password&quot; : &quot;functionalUserPassword&quot;,
    
    &quot;requirements&quot; : [
        {
            &quot;conditions&quot; : [
                {
                    &quot;jmespath&quot; : &quot;identity=='pkg:maven/com.othercompany.library/artifact-name@1.0.0'&quot;
                },
                {
                    &quot;jmespath&quot; : &quot;flowContexts[?product == 'myProduct' &amp;&amp; track == 'myTrack']&quot;
                }
            ]
        }

    ]
}
</pre></div></div>

<p>Additional examples of how to write subscription requirements and conditions:</p>
<p>The below subscription contains 2 requirements. To trigger a notification an aggregation should contain a successful test case execution OR an artifact with a given identity AND a specific flowContext should be found in the aggregation.</p>

<div>
<div>
<pre class="source">{
    &quot;subscriptionName&quot;: &quot;Subscription1&quot;,
    &quot;repeat&quot;: false,

    &quot;notificationMeta&quot;: &quot;http://127.0.0.1:3000/ei/test_subscription_rest&quot;,
    &quot;notificationType&quot;: &quot;REST_POST&quot;,
    &quot;restPostBodyMediaType&quot;: &quot;application/x-www-form-urlencoded&quot;,
    &quot;notificationMessageKeyValues&quot;: [
        {
            &quot;formkey&quot;: &quot;external-api-parameter-name&quot;,
            &quot;formvalue&quot;: &quot;{parameters: [{ name: 'full_aggregation', value : to_string(@) }, { name: 'artifact_identity', value : '@.identity' }]}&quot;
        },
        {
            &quot;formkey&quot;: &quot;another-parameter&quot;,
            &quot;formvalue&quot;: &quot;@.flowContexts[?product == 'myAwesomeProduct']&quot;
        }
    ],
    &quot;requirements&quot;: [
        {
            &quot;conditions&quot;: [
                {
                    &quot;jmespath&quot;: &quot;testCaseExecutions[?testCase.conclusion == 'SUCCESSFUL' &amp;&amp; testCase.id=='TC5']&quot;
                }
            ]
        },
        {
            &quot;conditions&quot;: [
                {
                    &quot;jmespath&quot;: &quot;identity=='pkg:maven/com.mycompany.myproduct/artifact-name@1.0.0'&quot;
                },
                {
                    &quot;jmespath&quot;: &quot;flowContexts[?product == 'my/product/flow']&quot;
                }
            ]
        }
    ]
}
</pre></div></div>

<p>The below subscription will perform a REST POST notification when an artifact for issue JIRA-1234 has passed testcase TC5 successfully. The method &#x2018;incomplete_path_contains()&#x2019; used in the condition is predefined.</p>

<div>
<div>
<pre class="source">{
    &quot;subscriptionName&quot;: &quot;artifactRequirementSubscription&quot;,
    &quot;notificationMeta&quot;: &quot;http://127.0.0.1:3000/ei/test_subscription_rest&quot;,
    &quot;notificationType&quot;: &quot;REST_POST&quot;,
    &quot;restPostBodyMediaType&quot;: &quot;application/json&quot;,
    &quot;notificationMessageKeyValues&quot;: [
        {
            &quot;formkey&quot;: &quot;&quot;,
            &quot;formvalue&quot;: &quot;@&quot;
        }
    ],
    &quot;repeat&quot;: false,
    &quot;requirements&quot;: [
        {
            &quot;conditions&quot;: [
                {
                    &quot;jmespath&quot;: &quot;incomplete_path_contains(@, 'issues.id','JIRA-1234')&quot;
                },
                {
                    &quot;jmespath&quot;: &quot;(length(testCaseExecutions[?(outcome.id == 'TC5' &amp;&amp; outcome.conclusion == 'SUCCESSFUL')]) &gt; `0`)&quot;
                }
            ]
        }
    ]
}
</pre></div></div>
</div>
<div class="section">
<h2><a name="Requirements_and_conditions"></a>Requirements and conditions</h2>
<p>Read more on how Eiffel Intelligence groups <a class="externalLink" href="https://github.com/eiffel-community/eiffel-intelligence/blob/master/wiki/markdown/subscriptions.md#writing-requirements-and-conditions">requirements and conditions in subscriptions</a>.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                          
                </div>

        
                </div>
    </footer>
        </body>
</html>
