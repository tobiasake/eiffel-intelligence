<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2019-12-02 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20191202" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Eiffel Intelligence &#x2013; Running Rules On Objects</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

          
                      </head>
        <body class="topBarEnabled">
          
                
                    
                

    <div id="topbar" class="navbar navbar-fixed-top navbar-inverse">
      <div class="navbar-inner">
                <div class="container-fluid">
        <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
                
                                                                                                    <a class="brand" href="./" >

                                
                                    Eiffel Intelligence
                
                </a>
                    
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="index.html"  title="Home">Home</a>
</li>
                  
                      <li class="dropdown-submenu">
                                      <a href="running-eiffel-intelligence.html"  title="Running Eiffel Intelligence">Running Eiffel Intelligence</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="configuration.html"  title="Configuration">Configuration</a>
</li>
                                  <li>      <a href="docker.html"  title="Running in Docker">Running in Docker</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="subscriptions.html"  title="Understanding subscriptions">Understanding subscriptions</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="subscription-with-REST-POST-notification.html"  title="Subscription with REST POST notification">Subscription with REST POST notification</a>
</li>
                                  <li>      <a href="triggering-jenkins-jobs.html"  title="HTTP POST notification to trigger parameterized Jenkins jobs">HTTP POST notification to trigger parameterized Jenkins jobs</a>
</li>
                                  <li>      <a href="subscription-with-email-notification.html"  title="Subscription with Email notification">Subscription with Email notification</a>
</li>
                                  <li>      <a href="step-by-step-subscription-notification.html"  title="Step-by-step Subscription Notification">Step-by-step Subscription Notification</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="rules.html"  title="Understanding rules">Understanding rules</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="merge-resolver-rules.html"  title="Merge Resolver Rules">Merge Resolver Rules</a>
</li>
                                  <li>      <a href="history-rules.html"  title="History Rules">History Rules</a>
</li>
                                  <li>      <a href="example-rules.html"  title="Example Rules">Example Rules</a>
</li>
                                  <li>      <a href="mapping-rules-to-aggregations.html"  title="Mapping Rules To Aggregations">Mapping Rules To Aggregations</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="step-by-step-aggregation.html"  title="Step-by-step aggregation">Step-by-step aggregation</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="artifact-created-event-aggregation.html"  title="ArtifactCreatedEvent aggregation">ArtifactCreatedEvent aggregation</a>
</li>
                                  <li>      <a href="test-case-triggered-event-aggregation.html"  title="TestCaseTriggeredEvent aggregation">TestCaseTriggeredEvent aggregation</a>
</li>
                                  <li>      <a href="test-case-started-event-aggregation.html"  title="TestCaseStartedEvent aggregation">TestCaseStartedEvent aggregation</a>
</li>
                                  <li>      <a href="test-case-finished-event-aggregation.html"  title="TestCaseFinishedEvent aggregation">TestCaseFinishedEvent aggregation</a>
</li>
                                  <li>      <a href="artifact-published-event-aggregation.html"  title="ArtifactPublishedEvent aggregation">ArtifactPublishedEvent aggregation</a>
</li>
                                  <li>      <a href="confidence-level-modified-event-aggregation.html"  title="ConfidenceLevelModifiedEvent">ConfidenceLevelModifiedEvent</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="REST-API.html"  title="REST API">REST API</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="query.html"  title="Query">Query</a>
</li>
                                  <li>      <a href="failed-notifications.html"  title="Failed notifications">Failed notifications</a>
</li>
                                  <li>      <a href="running-rules-on-objects.html"  title="Running rules on objects">Running rules on objects</a>
</li>
                                  <li>      <a href="authentication.html"  title="Authentication">Authentication</a>
</li>
                                  <li>      <a href="subscription-API.html"  title="Subscriptions">Subscriptions</a>
</li>
                                  <li>      <a href="status.html"  title="Status">Status</a>
</li>
                                  <li>      <a href="templates.html"  title="Get templates">Get templates</a>
</li>
                              </ul>
            </li>
                  
                      <li>      <a href="compatibility.html"  title="Compatibility">Compatibility</a>
</li>
                  
                      <li>      <a href="known-limitations.html"  title="Known limitations">Known limitations</a>
</li>
                          </ul>
      </li>
                  </ul>
          
          
          
                   
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Eiffel Intelligence</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="index.html" title="Home">
        Home</a>
                    <span class="divider">-</span>
      </li>
        <li class="active ">Running Rules On Objects</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2019-12-02</li>
              <li id="projectVersion" class="pull-right">
                    Version: 2.0.0
        </li>
            
                            </ul>
      </div>

                  
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                              
      <li>
  
                          <a href="index.html" title="Home">
          <span class="none"></span>
        Home</a>
            </li>
                                                                                    
      <li>
  
                          <a href="running-eiffel-intelligence.html" title="Running Eiffel Intelligence">
          <span class="icon-chevron-right"></span>
        Running Eiffel Intelligence</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="subscriptions.html" title="Understanding subscriptions">
          <span class="icon-chevron-right"></span>
        Understanding subscriptions</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="rules.html" title="Understanding rules">
          <span class="icon-chevron-right"></span>
        Understanding rules</a>
                  </li>
                                                                                                                                                            
      <li>
  
                          <a href="step-by-step-aggregation.html" title="Step-by-step aggregation">
          <span class="icon-chevron-right"></span>
        Step-by-step aggregation</a>
                  </li>
                                                                                                                                                                                        
      <li>
  
                          <a href="REST-API.html" title="REST API">
          <span class="icon-chevron-down"></span>
        REST API</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="query.html" title="Query">
          <span class="none"></span>
        Query</a>
            </li>
                    
      <li>
  
                          <a href="failed-notifications.html" title="Failed notifications">
          <span class="none"></span>
        Failed notifications</a>
            </li>
                    
      <li class="active">
  
            <a href="#"><span class="none"></span>Running rules on objects</a>
          </li>
                    
      <li>
  
                          <a href="authentication.html" title="Authentication">
          <span class="none"></span>
        Authentication</a>
            </li>
                    
      <li>
  
                          <a href="subscription-API.html" title="Subscriptions">
          <span class="none"></span>
        Subscriptions</a>
            </li>
                    
      <li>
  
                          <a href="status.html" title="Status">
          <span class="none"></span>
        Status</a>
            </li>
                    
      <li>
  
                          <a href="templates.html" title="Get templates">
          <span class="none"></span>
        Get templates</a>
            </li>
              </ul>
        </li>
                
      <li>
  
                          <a href="compatibility.html" title="Compatibility">
          <span class="none"></span>
        Compatibility</a>
            </li>
                
      <li>
  
                          <a href="known-limitations.html" title="Known limitations">
          <span class="none"></span>
        Known limitations</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                        
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>Running Rules On Objects</h1>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th>Method</th>
<th>Endpoint                               </th></tr>
</thead><tbody>

<tr class="b">
<td>GET   </td>
<td> /rules                                </td></tr>
<tr class="a">
<td>POST  </td>
<td> /rule-test/run-single-rule                     </td></tr>
<tr class="b">
<td>POST  </td>
<td> /rule-test/run-full-aggregation         </td></tr>
<tr class="a">
<td>GET   </td>
<td> /rule-test </td></tr>
</tbody>
</table>
<div class="section">
<h2><a name="Checking_the_active_rules_in_your_backend_instance"></a>Checking the active rules in your backend instance</h2>
<p>You can fetch the rules content from the backend to see what rules Eiffel Intelligence is currently using. This can give you an idea on how to write your own rules or could be saved and used in the /rule-test/run-single-rule endpoints to test the current rules against your events.</p>

<div>
<div>
<pre class="source">curl -X GET http://&lt;host&gt;:8090/rules
</pre></div></div>
</div>
<div class="section">
<h2><a name="Testing_rules_and_events_in_Eiffel_Intelligence"></a>Testing rules and events in Eiffel Intelligence</h2>
<p>Before deploying a new instance of Eiffel Intelligence it is good to test the desired rules that they give the desired outcome. Therefore it is possible to test the rules on a test instance of Eiffel Intelligence. This means that this instance needs to be dedicated to only testing rules and it can be one per company, organization or department. In this way every user testing will get its own test space that will be removed after feedback to the user. The property controlling this feature should be set to true:</p>

<div>
<div>
<pre class="source">testaggregated.enabled: true
</pre></div></div>

<p>A GUI is also implemented in <a class="externalLink" href="https://github.com/eiffel-community/eiffel-intelligence-frontend">Eiffel Intelligence Frontend</a> but only visible when above property is set to true in the backend (this application).</p></div>
<div class="section">
<h2><a name="Check_if_testRules_are_enabled_on_the_selected_instance"></a>Check if testRules are enabled on the selected instance</h2>
<p>Using the following endpoint one can check if rule tests are enabled in the EI instance.</p>

<div>
<div>
<pre class="source">curl -X GET http://&lt;host&gt;:8090/rule-test
</pre></div></div>
</div>
<div class="section">
<h2><a name="Test_JMESPath_expression_on_given_Event"></a>Test JMESPath expression on given Event</h2>
<p>This endpoint allows to test the result of a JMESPath expression of an event.</p>

<div>
<div>
<pre class="source">POST /rule-test/run-single-rule
</pre></div></div>

<p><b>Body (application/json)</b></p>

<div>
<div>
<pre class="source">{
  &quot;rule&quot;: &lt;JMESPATH Expression&gt;,
  &quot;event&quot; &lt;Eiffel Event&gt;:
}
</pre></div></div>

<p>Examples of this endpoint using curl</p>

<div>
<div>
<pre class="source">curl -X POST -H &quot;Content-type:application/json&quot; --data @body.json http://localhost:8090/rule-test/run-single-rule
</pre></div></div>

<p>For example if we run the following JMESPath expression:</p>

<div>
<div>
<pre class="source">{
   id:meta.id,
   type:meta.type,
   time:meta.time,
   identity:data.identity,
   fileInformation:data.fileInformation,
   buildCommand:data.buildCommand
}
</pre></div></div>

<p>on Eiffel event:</p>

<div>
<div>
<pre class="source">{
   &quot;links&quot;: [
      {
         &quot;target&quot;: &quot;1921bc9f-59e1-45b7-8bb1-26602ed667b1&quot;,
         &quot;type&quot;: &quot;COMPOSITION&quot;
      },
      {
         &quot;target&quot;: &quot;1921bc9f-59e1-45b7-8bb1-26602ed667b1&quot;,
         &quot;type&quot;: &quot;CAUSE&quot;
      },
      {
         &quot;target&quot;: &quot;55da5d47-fb10-43c8-97d2-cbd5eb9a2676&quot;,
         &quot;type&quot;: &quot;PREVIOUS_VERSION&quot;
      }
   ],
   &quot;meta&quot;: {
      &quot;id&quot;: &quot;e90daae3-bf3f-4b0a-b899-67834fd5ebd0&quot;,
      &quot;source&quot;: {
         &quot;domainId&quot;: &quot;example.domain&quot;
      },
      &quot;time&quot;: 1484061386383,
      &quot;type&quot;: &quot;EiffelArtifactCreatedEvent&quot;,
      &quot;version&quot;: &quot;3.0.0&quot;
   },
   &quot;data&quot;: {
      &quot;customData&quot;: [
         {
            &quot;value&quot;: &quot;ArtCC1&quot;,
            &quot;key&quot;: &quot;name&quot;
         },
         {
            &quot;value&quot;: 5000,
            &quot;key&quot;: &quot;iteration&quot;
         }
      ],
      &quot;fileInformation&quot;: [
         {
            &quot;classifier&quot;: &quot;&quot;,
            &quot;extension&quot;: &quot;jar&quot;
         }
      ],
      &quot;identity&quot;: &quot;pkg:maven/com.mycompany.myproduct/component-1@1.5000.0&quot;
   }
}
</pre></div></div>

<p>will give</p>

<div>
<div>
<pre class="source">{
  &quot;id&quot;: &quot;e90daae3-bf3f-4b0a-b899-67834fd5ebd0&quot;,
  &quot;type&quot;: &quot;EiffelArtifactCreatedEvent&quot;,
  &quot;time&quot;: 1484061386383,
  &quot;identity&quot;: &quot;pkg:maven/com.mycompany.myproduct/component-1@1.5000.0&quot;,
  &quot;fileInformation&quot;: [
    {
      &quot;classifier&quot;: &quot;&quot;,
      &quot;extension&quot;: &quot;jar&quot;
    }
  ],
  &quot;buildCommand&quot;: null
}
</pre></div></div>
</div>
<div class="section">
<h2><a name="Test_a_list_of_rule_sets_on_given_list_of_events"></a>Test a list of rule sets on given list of events</h2>
<p>This end point is to test a complete aggregation using rule sets for every event you need to be aggregated. And a list of events. The result is the aggregated object containing the desired information from the events as you have specified in the rules.</p>

<div>
<div>
<pre class="source">POST /rule-test/run-full-aggregation
</pre></div></div>

<p><b>Body (application/json)</b></p>

<div>
<div>
<pre class="source">{
   &quot;listEventsJson&quot;: &lt;Eiffel Events&gt;,
   &quot;listRulesJson&quot;:  &lt;Rules&gt;
}
</pre></div></div>

<p>Examples of this endpoint using curl</p>

<div>
<div>
<pre class="source">curl -X POST -H &quot;Content-type: application/json&quot;  --data @body.json  http://localhost:8090/rule-test/run-full-aggregation
</pre></div></div>

<p>For demo you can use following list of <a class="externalLink" href="https://github.com/eiffel-community/eiffel-intelligence/blob/master/src/test/resources/AggregateListEvents.json">events</a> and list of <a class="externalLink" href="https://github.com/eiffel-community/eiffel-intelligence/blob/master/src/test/resources/AggregateListRules.json">rules</a>. They can be used to create a json with the structure as above and when send as body to the endpoint you should get following <a class="externalLink" href="https://github.com/eiffel-community/eiffel-intelligence/blob/master/src/test/resources/AggregateResultObject.json">aggregation result</a></p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                          
                </div>

        
                </div>
    </footer>
        </body>
</html>
